plugins {
    id 'idea'
    id 'java'
    id 'jacoco'
    id 'war'
}

configurations {
    codacy
}

repositories {
    mavenCentral()
    jcenter()
    maven {
        url "https://oss.jfrog.org/artifactory/libs-release"
    }
}

dependencies {
    compile 'org.glassfish.jersey.bundles:jaxrs-ri:2.29.1'
    compile 'javax.xml.bind:jaxb-api:2.3.0'
    compile 'javax.activation:activation:1.1'
    compile 'com.github.twitch4j:twitch4j:1.0.0-alpha.18'
    
    codacy 'com.codacy:codacy-coverage-reporter:latest.release'
}

war {
    archiveName "ROOT.war"
}

wrapper {
    version '6.1'
}

task sendCoverageToCodacy(type: JavaExec, dependsOn: jacocoTestReport) {
    main = "com.codacy.CodacyCoverageReporter"
    classpath = configurations.codacy
    args = [
            "report",
            "-l",
            "Java",
            "-r",
            "${buildDir}/reports/jacoco/test/jacocoTestReport.xml"
    ]
}
